<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ÙˆØ§ØªØ³ Ù…ØµØ±ÙŠ - Ø¯Ø±Ø¯Ø´Ø© Ù…Ù…ÙŠØ²Ø©</title>
<style>
  body {
    margin: 0; padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea, #764ba2);
    color: #eee;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #app {
    width: 95vw;
    max-width: 1100px;
    height: 90vh;
    background: #222;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.7);
    display: flex;
    overflow: hidden;
  }
  /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡ */
  #friendsList {
    width: 320px;
    background: #333;
    padding: 15px;
    overflow-y: auto;
    border-right: 2px solid #5a4db9;
  }
  #friendsList h2 {
    text-align: center;
    margin-bottom: 20px;
    font-weight: 800;
    font-size: 1.5rem;
    color: #cdb4db;
  }
  .friend {
    background: #444;
    margin-bottom: 12px;
    border-radius: 10px;
    cursor: pointer;
    display: flex;
    align-items: center;
    padding: 10px 12px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.3);
    transition: background 0.3s, transform 0.2s;
    user-select: none;
  }
  .friend:hover, .friend.active {
    background: #5a4db9;
    transform: scale(1.05);
    box-shadow: 0 0 12px #bda0f0;
    color: #fff;
  }
  .friend img {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    margin-left: 15px;
    border: 2px solid #bda0f0;
    object-fit: cover;
    flex-shrink: 0;
  }
  .friend .name {
    flex-grow: 1;
    font-weight: 700;
    font-size: 1.2rem;
  }
  .friend .status-dot {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    box-shadow: 0 0 6px #4caf50;
  }
  .status-online {
    background-color: #4caf50;
  }
  .status-offline {
    background-color: #777;
    box-shadow: none;
  }

  /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¯Ø±Ø¯Ø´Ø© */
  #chatArea {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    background: #121212;
    border-radius: 0 15px 15px 0;
    overflow: hidden;
  }
  #chatHeader {
    background: linear-gradient(90deg, #5a4db9, #bda0f0);
    padding: 18px 25px;
    color: #fff;
    font-weight: 900;
    font-size: 1.6rem;
    display: flex;
    align-items: center;
    gap: 15px;
    box-shadow: 0 4px 12px rgba(91,77,185,0.6);
  }
  #chatHeader img {
    width: 55px;
    height: 55px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #fff;
  }

  #chatMessages {
    flex-grow: 1;
    padding: 20px;
    overflow-y: auto;
    background: linear-gradient(to bottom, #171717, #292929);
  }
  #chatMessages p {
    color: #999;
    font-size: 1.2rem;
    text-align: center;
    margin-top: 50px;
  }

  /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
  .message {
    max-width: 60%;
    padding: 14px 18px;
    margin-bottom: 16px;
    border-radius: 25px;
    position: relative;
    font-size: 1.1rem;
    line-height: 1.4;
    word-wrap: break-word;
    box-shadow: 0 3px 8px rgba(0,0,0,0.7);
    opacity: 0;
    animation: fadeInMessage 0.5s forwards;
    transition: background-color 0.3s, transform 0.2s;
  }
  .message.sent {
    background: #6c63ff;
    color: #fff;
    margin-left: auto;
    border-bottom-right-radius: 4px;
    box-shadow: 0 0 15px #7f6cff;
  }
  .message.sent:hover {
    background: #5848c2;
    transform: scale(1.05);
  }
  .message.received {
    background: #333;
    color: #ddd;
    margin-right: auto;
    border-bottom-left-radius: 4px;
  }
  .message.received:hover {
    background: #444;
    transform: scale(1.05);
  }

  /* Ø·Ø§Ø¨Ø¹ Ø§Ù„ÙˆÙ‚Øª */
  .timestamp {
    font-size: 0.75rem;
    color: #bbb;
    position: absolute;
    bottom: 6px;
  }
  .message.sent .timestamp {
    left: 12px;
  }
  .message.received .timestamp {
    right: 12px;
  }

  /* ØµÙˆØ± Ø¯Ø§Ø®Ù„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ */
  .message-img {
    max-width: 100%;
    border-radius: 18px;
    margin-top: 8px;
    box-shadow: 0 4px 10px rgba(108,99,255,0.7);
    cursor: pointer;
    transition: transform 0.3s ease;
  }
  .message-img:hover {
    transform: scale(1.07);
  }

  /* ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ */
  #inputArea {
    background: #2a2378;
    padding: 14px 25px;
    display: flex;
    align-items: center;
    gap: 12px;
  }
  #messageInput {
    flex-grow: 1;
    padding: 12px 18px;
    border-radius: 25px;
    border: none;
    font-size: 1.1rem;
    outline: none;
    background: #3e3a8c;
    color: #eee;
    box-shadow: inset 0 0 10px #524fd6;
    transition: background-color 0.3s;
  }
  #messageInput::placeholder {
    color: #ccc;
  }
  #messageInput:focus {
    background: #5951e4;
  }
  #sendBtn {
    background: #8c7dff;
    border: none;
    color: #fff;
    padding: 12px 25px;
    font-weight: 700;
    font-size: 1.1rem;
    border-radius: 25px;
    cursor: pointer;
    box-shadow: 0 0 12px #aea4ff;
    transition: background-color 0.3s, transform 0.2s;
  }
  #sendBtn:hover {
    background: #6c63ff;
    transform: scale(1.1);
  }
  #sendBtn:active {
    transform: scale(0.95);
  }
  #imageInput {
    display: none;
  }
  #uploadLabel {
    cursor: pointer;
    font-size: 1.6rem;
    color: #bda0f0;
    user-select: none;
    transition: color 0.3s;
  }
  #uploadLabel:hover {
    color: #8c7dff;
  }

  /* Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ØªØªØ­Ø±Ùƒ ÙˆØªØ¸Ù‡Ø± */
  @keyframes fadeInMessage {
    from {opacity: 0; transform: translateY(15px);}
    to {opacity: 1; transform: translateY(0);}
  }
</style>
</head>
<body>
<div id="app">
  <div id="friendsList">
    <h2>Ø´Ù„Ø© Ø£ØµØ­Ø§Ø¨Ùƒ</h2>
  </div>

  <div id="chatArea">
    <div id="chatHeader">
      <img src="" alt="ØµÙˆØ±Ø© ØµØ§Ø­Ø¨ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©" id="friendImg" />
      <span id="friendName">Ø§Ø®ØªØ§Ø± ØµØ§Ø­Ø¨</span>
    </div>
    <div id="chatMessages">
      <p>Ù…Ø§ÙÙŠØ´ Ø±Ø³Ø§Ø¦Ù„ Ù„Ø­Ø¯ Ø¯Ù„ÙˆÙ‚ØªÙŠ.</p>
    </div>
    <div id="inputArea">
      <label for="imageInput" id="uploadLabel" title="Ø§Ø±Ø³Ù„ ØµÙˆØ±Ø© ğŸ“·">&#128247;</label>
      <input type="file" id="imageInput" accept="image/*" />
      <input type="text" id="messageInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©..." autocomplete="off" />
      <button id="sendBtn">Ø¥Ø±Ø³Ø§Ù„</button>
    </div>
  </div>
</div>

<script>
  // Ù‚Ø§Ø¦Ù…Ø© Ø£ØµØ­Ø§Ø¨ Ø§Ù„Ø´Ù„Ø© Ù…Ø¹ Ø§Ø³Ù… ÙˆØµÙˆØ±Ø© ÙˆØ­Ø§Ù„Ø©
  const friends = [
    { id: 1, name: "Ø£Ø­Ù…Ø¯", status: "online", image: "https://i.pravatar.cc/60?img=3", messages: [] },
    { id: 2, name: "Ø³Ø§Ø±Ø©", status: "offline", image: "https://i.pravatar.cc/60?img=12", messages: [] },
    { id: 3, name: "Ù…Ø­Ù…ÙˆØ¯", status: "online", image: "https://i.pravatar.cc/60?img=15", messages: [] },
  ];

  // ÙƒÙ„Ù…Ø§Øª Ø¨Ø°ÙŠØ¦Ø© Ù…Ù…Ù†ÙˆØ¹Ø©
  const bannedWords = [
    "ÙƒÙ„Ù…Ø©Ø¨Ø°ÙŠØ¦Ø©1",
    "ÙƒÙ„Ù…Ø©Ø¨Ø°ÙŠØ¦Ø©2",
    "ÙƒÙ„Ù…Ø©Ø¨Ø°ÙŠØ¦Ø©3",
    "ÙƒÙ„Ù…Ù†ÙŠ",  // Ù…Ø¬Ø±Ø¯ Ù…Ø«Ø§Ù„ ØªØ¶ÙŠÙ Ø§Ù„Ù„ÙŠ ØªØ­Ø¨
  ];

  const friendsList = document.getElementById("friendsList");
  const friendImg = document.getElementById("friendImg");
  const friendName = document.getElementById("friendName");
  const chatMessages = document.getElementById("chatMessages");
  const messageInput = document.getElementById("messageInput");
  const sendBtn = document.getElementById("sendBtn");
  const imageInput = document.getElementById("imageInput");

  let currentFriend = null;

  // ÙÙ„ØªØ± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù„Ù…Ù†Ø¹ Ø§Ù„ÙƒÙ„Ø§Ù… Ø§Ù„Ø¨Ø°ÙŠØ¡
  function filterBadWords(text) {
    let filtered = text;
    bannedWords.forEach(word => {
      const regex = new RegExp(word, "gi");
      filtered = filtered.replace(regex, "****");
    });
    return filtered;
  }

  // Ø¹Ø±Ø¶ Ø§Ù„Ø£ØµØ¯Ù‚Ø§Ø¡
  function renderFriends() {
    friendsList.querySelectorAll(".friend").forEach(el => el.remove());

    friends.forEach(friend => {
      const div = document.createElement("div");
      div.classList.add("friend");
      if (currentFriend && currentFriend.id === friend.id) {
        div.classList.add("active");
      }
      div.innerHTML = `
        <img src="${friend.image}" alt="ØµÙˆØ±Ø© ${friend.name}" />
        <span class="name">${friend.name}</span>
        <span class="status-dot ${friend.status === "online" ? "status-online" : "status-offline"}" title="${friend.status}"></span>
      `;
      div.addEventListener("click", () => {
        currentFriend = friend;
        friendName.textContent = friend.name;
        friendImg.src = friend.image;
        renderFriends();
        renderMessages();
      });
      friendsList.appendChild(div);
    });
  }

  // Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ù…Ø¹ ØªØ£Ø«ÙŠØ±Ø§Øª Ø­ÙŠÙˆÙŠØ©
  function renderMessages() {
    chatMessages.innerHTML = "";
    if (!currentFriend || currentFriend.messages.length === 0) {
      chatMessages.innerHTML = "<p>Ù…Ø§ÙÙŠØ´ Ø±Ø³Ø§Ø¦Ù„ Ù„Ø­Ø¯ Ø¯Ù„ÙˆÙ‚ØªÙŠ.</p>";
      return;
    }

    currentFriend.messages.forEach(msg => {
      const msgDiv = document.createElement("div");
      msgDiv.classList.add("message");
      msgDiv.classList.add(msg.sent ? "sent" : "received");
      msgDiv.style.animationDelay = (0.1 * Math.random()) + "s";

      // Ù†Øµ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø¹ ÙÙ„ØªØ± Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø¨Ø°ÙŠØ¦Ø©
      const safeText = filterBadWords(msg.text);
      msgDiv.textContent = safeText;

      if (msg.image) {
        const img = document.createElement("img");
        img.src = msg.image;
        img.alt = "ØµÙˆØ±Ø© Ù…Ø±ÙÙ‚Ø©";
        img.className = "message-img";
        msgDiv.appendChild(img);
      }

      const timeSpan = document.createElement("span");
      timeSpan.className = "timestamp";
      timeSpan.textContent = msg.time;
      msgDiv.appendChild(timeSpan);

      chatMessages.appendChild(msgDiv);
    });

    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  // Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø§Ù„ØªØ£Ø«ÙŠØ±
  function addMessage(text, image = null) {
    if (!currentFriend) {
      alert("Ø§Ø®ØªØ§Ø± ØµØ§Ø­Ø¨ Ù„Ù„Ø¯Ø±Ø¯Ø´Ø© Ø£ÙˆÙ„Ø§Ù‹!");
      return;
    }
    if (!text && !image) return;

    const now = new Date();
    const time = now.toLocaleTimeString("ar-EG", { hour: "2-digit", minute: "2-digit" });

    currentFriend.messages.push({
      text: text,
      image: image,
      sent: true,
      time: time
    });

    renderMessages();
  }

  sendBtn.addEventListener("click", () => {
    addMessage(messageInput.value.trim());
    messageInput.value = "";
    messageInput.focus();
  });

  messageInput.addEventListener("keydown", e => {
    if (e.key === "Enter") {
      e.preventDefault();
      sendBtn.click();
    }
  });

  imageInput.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (file && file.type.startsWith("image/")) {
      const reader = new FileReader();
      reader.onload = (ev) => {
        addMessage("", ev.target.result);
      };
      reader.readAsDataURL(file);
    }
    imageInput.value = "";
  });

  renderFriends();
</script>
</body>
</html>
